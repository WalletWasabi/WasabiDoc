<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.7" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <title>Network-Level Privacy | Wasabi Docs</title><meta name="description" content="A comparison of the network-level privacy of Wasabi wallet and Bitcoin Core. This is the Wasabi documentation, an archive of knowledge about the open-source, non-custodial and privacy-focused Bitcoin wallet for desktop.">
    <link rel="preload" href="/assets/style-JnVFbNtO.css" as="style"><link rel="stylesheet" href="/assets/style-JnVFbNtO.css">
    <link rel="modulepreload" href="/assets/app-B4LRDA6D.js"><link rel="modulepreload" href="/assets/NetworkLevelPrivacy.html-CwsmdwPK.js"><link rel="modulepreload" href="/assets/Logo_without_text_with_bg_dark_with_yt-D8lqXhN0.js">
    <link rel="prefetch" href="/assets/index.html-BFRA4K8P.js" as="script"><link rel="prefetch" href="/assets/FAQ-Contribution.html-x6vchUuW.js" as="script"><link rel="prefetch" href="/assets/FAQ-GeneralBitcoinPrivacy.html-BUQyQRW2.js" as="script"><link rel="prefetch" href="/assets/FAQ-Installation.html-CUME03bd.js" as="script"><link rel="prefetch" href="/assets/FAQ-Introduction.html-CRvlsH6T.js" as="script"><link rel="prefetch" href="/assets/FAQ-UseWasabi.html-BZnaRMPB.js" as="script"><link rel="prefetch" href="/assets/index.html-Bynh6rAF.js" as="script"><link rel="prefetch" href="/assets/ContributionChecklist.html-CN24OW2X.js" as="script"><link rel="prefetch" href="/assets/LICENSE.html-CdPea5xk.js" as="script"><link rel="prefetch" href="/assets/index.html-QhSuWb9e.js" as="script"><link rel="prefetch" href="/assets/Security.html-DUFd63YQ.js" as="script"><link rel="prefetch" href="/assets/index.html-B5iZZ3E3.js" as="script"><link rel="prefetch" href="/assets/Glossary-GeneralBitcoin.html-C04shFAN.js" as="script"><link rel="prefetch" href="/assets/Glossary-PrivacyWasabi.html-C3US37gO.js" as="script"><link rel="prefetch" href="/assets/index.html-B12zOvI5.js" as="script"><link rel="prefetch" href="/assets/BIPs.html-YMAY1Lxb.js" as="script"><link rel="prefetch" href="/assets/BackupBestPractices.html-CqNZFdAl.js" as="script"><link rel="prefetch" href="/assets/BitcoinFullNode.html-D2ThwXME.js" as="script"><link rel="prefetch" href="/assets/BuildSource.html-COb1BFC5.js" as="script"><link rel="prefetch" href="/assets/ChangeCoins.html-Bp0D3FQu.js" as="script"><link rel="prefetch" href="/assets/CoinJoin.html-CsghBUyv.js" as="script"><link rel="prefetch" href="/assets/ColdWasabi.html-BNbjGu0c.js" as="script"><link rel="prefetch" href="/assets/Daemon.html-RHj3YA9a.js" as="script"><link rel="prefetch" href="/assets/DeterministicBuild.html-BuFzrT72.js" as="script"><link rel="prefetch" href="/assets/DiscreetMode.html-DopKzYcS.js" as="script"><link rel="prefetch" href="/assets/ELI5.html-C-v__xr8.js" as="script"><link rel="prefetch" href="/assets/ExternalRestore.html-Be4c72Ig.js" as="script"><link rel="prefetch" href="/assets/InstallPackage.html-MGgXq4pZ.js" as="script"><link rel="prefetch" href="/assets/PasswordBestPractices.html-CoE_NQWe.js" as="script"><link rel="prefetch" href="/assets/PayJoin.html-DQCoriGG.js" as="script"><link rel="prefetch" href="/assets/index.html-D2C9kktY.js" as="script"><link rel="prefetch" href="/assets/RPC.html-JHQYeuEc.js" as="script"><link rel="prefetch" href="/assets/Receive.html-BUJE8ouR.js" as="script"><link rel="prefetch" href="/assets/Send.html-q_8B8797.js" as="script"><link rel="prefetch" href="/assets/StartupParameters.html-BRff6eNC.js" as="script"><link rel="prefetch" href="/assets/Testnet.html-CqjAkO5_.js" as="script"><link rel="prefetch" href="/assets/WalletGeneration.html-ZT1WNijc.js" as="script"><link rel="prefetch" href="/assets/WalletLoad.html-BxOg4qIA.js" as="script"><link rel="prefetch" href="/assets/WalletRecovery.html-CE_Up9J3.js" as="script"><link rel="prefetch" href="/assets/WasabiSetupVM.html-na-Af8ki.js" as="script"><link rel="prefetch" href="/assets/AddressReuse.html-C5cRASbT.js" as="script"><link rel="prefetch" href="/assets/Coins.html-CL380K8N.js" as="script"><link rel="prefetch" href="/assets/index.html-R1idj5oo.js" as="script"><link rel="prefetch" href="/assets/TransactionGraph.html-BkAtKpN2.js" as="script"><link rel="prefetch" href="/assets/TransactionSurveillanceCompanies.html-DkKRLJbF.js" as="script"><link rel="prefetch" href="/assets/WhyFinancialPrivacy.html-CtLI3G8J.js" as="script"><link rel="prefetch" href="/assets/WhyPrivacyImportant.html-Di-tGvfm.js" as="script"><link rel="prefetch" href="/assets/404.html-C3UN-6a8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="site-name can-hide" aria-hidden="true">Wasabi Docs</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/getting-started/" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link route-link-active" href="/why-wasabi/" aria-label="Why Wasabi"><!--[--><!--]--> Why Wasabi <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/using-wasabi/" aria-label="Using Wasabi"><!--[--><!--]--> Using Wasabi <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/building-wasabi/" aria-label="Building Wasabi"><!--[--><!--]--> Building Wasabi <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/FAQ/" aria-label="FAQ"><!--[--><!--]--> FAQ <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/glossary/" aria-label="Glossary"><!--[--><!--]--> Glossary <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search..." autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><a class="route-link" href="/getting-started/" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link route-link-active" href="/why-wasabi/" aria-label="Why Wasabi"><!--[--><!--]--> Why Wasabi <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/using-wasabi/" aria-label="Using Wasabi"><!--[--><!--]--> Using Wasabi <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/building-wasabi/" aria-label="Building Wasabi"><!--[--><!--]--> Building Wasabi <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/FAQ/" aria-label="FAQ"><!--[--><!--]--> FAQ <!--[--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/glossary/" aria-label="Glossary"><!--[--><!--]--> Glossary <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Why Privacy <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/why-wasabi/WhyPrivacyImportant.html" aria-label="Why Privacy is Important"><!--[--><!--]--> Why Privacy is Important <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/why-wasabi/WhyFinancialPrivacy.html" aria-label="Why Financial Privacy is Especially Important"><!--[--><!--]--> Why Financial Privacy is Especially Important <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active">Privacy in Bitcoin <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/why-wasabi/Coins.html" aria-label="Coins"><!--[--><!--]--> Coins <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/why-wasabi/AddressReuse.html" aria-label="Address Reuse"><!--[--><!--]--> Address Reuse <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/why-wasabi/TransactionGraph.html" aria-label="Transaction Graph"><!--[--><!--]--> Transaction Graph <!--[--><!--]--></a><!----></li><li><a class="route-link route-link-active sidebar-item active" href="/why-wasabi/NetworkLevelPrivacy.html" aria-label="Network-Level Privacy"><!--[--><!--]--> Network-Level Privacy <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#problem" aria-label="Problem"><!--[--><!--]--> Problem <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#clearnet-light-clients" aria-label="Clearnet light clients"><!--[--><!--]--> Clearnet light clients <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#wasabi-s-solution" aria-label="Wasabi&#39;s solution"><!--[--><!--]--> Wasabi&#39;s solution <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#block-filters-over-tor" aria-label="Block filters over Tor"><!--[--><!--]--> Block filters over Tor <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#in-depth-comparison" aria-label="In-depth comparison"><!--[--><!--]--> In-depth comparison <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#bitcoin-core" aria-label="Bitcoin Core"><!--[--><!--]--> Bitcoin Core <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#bitcoin-core-tor" aria-label="Bitcoin Core + Tor"><!--[--><!--]--> Bitcoin Core + Tor <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#wasabi-wallet-light-node" aria-label="Wasabi Wallet light node"><!--[--><!--]--> Wasabi Wallet light node <!--[--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="/#wasabi-wallet-full-node" aria-label="Wasabi Wallet + full node"><!--[--><!--]--> Wasabi Wallet + full node <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/#universal-attacks" aria-label="Universal Attacks"><!--[--><!--]--> Universal Attacks <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="/#protection" aria-label="Protection"><!--[--><!--]--> Protection <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="/why-wasabi/TransactionSurveillanceCompanies.html" aria-label="Transaction Surveillance Companies"><!--[--><!--]--> Transaction Surveillance Companies <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="network-level-privacy-bitcoin-core-vs-wasabi-wallet" tabindex="-1"><a class="header-anchor" href="#network-level-privacy-bitcoin-core-vs-wasabi-wallet"><span>Network-Level Privacy - Bitcoin Core vs Wasabi Wallet</span></a></h1><p>Bitcoin is a peer-to-peer network of full nodes that define, verify, and enforce the Bitcoin consensus rules. There is a lot of communication between them and metadata can be used to de-anonymize Bitcoin users.</p><nav class="table-of-contents"><ul><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#problem" class="router-link-active router-link-exact-active">Problem</a><ul><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#clearnet-light-clients" class="router-link-active router-link-exact-active">Clearnet light clients</a></li></ul></li><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#wasabi-s-solution" class="router-link-active router-link-exact-active">Wasabi&#39;s solution</a><ul><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#block-filters-over-tor" class="router-link-active router-link-exact-active">Block filters over Tor</a></li></ul></li><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#in-depth-comparison" class="router-link-active router-link-exact-active">In-depth comparison</a><ul><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#bitcoin-core" class="router-link-active router-link-exact-active">Bitcoin Core</a></li><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#bitcoin-core-tor" class="router-link-active router-link-exact-active">Bitcoin Core + Tor</a></li><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#wasabi-wallet-light-node" class="router-link-active router-link-exact-active">Wasabi Wallet light node</a></li><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#wasabi-wallet-full-node" class="router-link-active router-link-exact-active">Wasabi Wallet + full node</a></li></ul></li><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#universal-attacks" class="router-link-active router-link-exact-active">Universal Attacks</a><ul><li><a aria-current="page" href="/why-wasabi/NetworkLevelPrivacy.html#protection" class="router-link-active router-link-exact-active">Protection</a></li></ul></li></ul></nav><h2 id="problem" tabindex="-1"><a class="header-anchor" href="#problem"><span>Problem</span></a></h2><h3 id="clearnet-light-clients" tabindex="-1"><a class="header-anchor" href="#clearnet-light-clients"><span>Clearnet light clients</span></a></h3><p>When the communication to the network is unencrypted over clearnet, then there is an easy correlation of the Bitcoin transactions to the IP address of the peer who sent it. The IP address can even be used to find the physical location of the user!</p><p>A Bitcoin full node broadcasts not just the transactions of its user, but it also gossips all of the other transactions that it has received from its peers. Thus it is very difficult to find out which transactions originated from which full node. However, when a node or a wallet does not gossip all transactions, but only the transactions of its user, then it is easier to find out which node has sent those specific transactions.</p><p>There are light wallets, which query a backend server to get information regarding specific addresses or use <a href="https://github.com/bitcoin/bips/blob/master/bip-0037.mediawiki" target="_blank" rel="noopener noreferrer">BIP 37<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> bloom filtering SPV wallet protocol, which is <a href="https://jonasnick.github.io/blog/2015/02/12/privacy-in-bitcoinj/" target="_blank" rel="noopener noreferrer">extremely bad for privacy<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. And there is Electrum, which <a href="https://www.reddit.com/r/Bitcoin/comments/2feox9/electrum_securityprivacy_model/ck8szc0/" target="_blank" rel="noopener noreferrer">sends your addresses<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to random Electrum servers.</p><div class="custom-container danger"><p class="custom-container-title">DANGER</p><p>When the user sends the extended public key or a filter of all the addresses to the central server, then the server can <strong>COMPLETELY</strong> deanonymize the users.</p></div><h2 id="wasabi-s-solution" tabindex="-1"><a class="header-anchor" href="#wasabi-s-solution"><span>Wasabi&#39;s solution</span></a></h2><h3 id="block-filters-over-tor" tabindex="-1"><a class="header-anchor" href="#block-filters-over-tor"><span>Block filters over Tor</span></a></h3><p>Wasabi checks if there is a local Tor instance installed, and if so, it uses this to onion-route all the traffic to and from the network. If Tor is not already installed, then it is accessed automatically from within Wasabi. This means that by default, all network communication is secured from outside snooping and the IP address is hidden.</p><p>Wasabi has a client-backend design that does not compromise user privacy. Meaning that even without using a full node the user stays private. The Wasabi indexer (backend) sends a block filter of all the transactions in each block to all the clients. Then, users check locally if the block contains any transactions with their addresses. If not, then the filter is stored for later reference, and no block is downloaded. However, if there is a user transaction in that block, then Wasabi requests the block from a random Bitcoin P2P node. This block request is indistinguishable from the regular P2P gossip.</p><p>In order to fully verify everything, running a full node is essential. Wasabi can connect to a full node using the RPC interface. If connected, Wasabi fetches the blocks and <a class="route-link" href="/using-wasabi/BitcoinFullNode.html#how-does-wasabi-use-your-bitcoin-full-node">other data</a> from the node.</p><div class="custom-container tip"><p class="custom-container-title">Privacy by default!</p><p>Wasabi has network-level privacy as good as a Bitcoin full node.</p></div><h2 id="in-depth-comparison" tabindex="-1"><a class="header-anchor" href="#in-depth-comparison"><span>In-depth comparison</span></a></h2><p>Furthermore, network-level privacy consists of two sub-categories.</p><ul><li>Private UTXO Retrieval</li><li>Private Transaction Broadcasting</li></ul><h3 id="bitcoin-core" tabindex="-1"><a class="header-anchor" href="#bitcoin-core"><span>Bitcoin Core</span></a></h3><h4 id="private-utxo-retrieval" tabindex="-1"><a class="header-anchor" href="#private-utxo-retrieval"><span>Private UTXO retrieval</span></a></h4><p>Bitcoin Core downloads all the blocks ever created and establishes your wallet balances locally. This is as good as it gets.</p><h4 id="private-transaction-broadcasting" tabindex="-1"><a class="header-anchor" href="#private-transaction-broadcasting"><span>Private transaction broadcasting</span></a></h4><p>Bitcoin Core broadcasts transactions to other peers on the clearnet, unencrypted. Other peers cannot figure out which transaction originates from a specific node because Core does not only broadcast its own transactions but also propagates every other transaction that hits its mempool. However, some papers note it’s not bulletproof:</p><blockquote><p>Bitcoin transaction propagation does not hide the source of a transaction very well, especially against a “supernode” eavesdropper that forms a large number of outgoing connections to reachable nodes on the network. <a href="https://github.com/bitcoin/bips/blob/master/bip-0156.mediawiki" target="_blank" rel="noopener noreferrer">Dandelion: Privacy-Preserving Transaction Propagation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></blockquote><h4 id="adversaries-identified" tabindex="-1"><a class="header-anchor" href="#adversaries-identified"><span>Adversaries identified</span></a></h4><ul><li>Malicious Peer</li><li>Supernode</li></ul><h3 id="bitcoin-core-tor" tabindex="-1"><a class="header-anchor" href="#bitcoin-core-tor"><span>Bitcoin Core + Tor</span></a></h3><p>You can use Bitcoin Core with Tor, which solves some of the above-mentioned issues. In this case, a supernode cannot track back transactions to your IP address.</p><p>An entity that can break Tor is a universal adversary, however, most Tor attacks are not possible if exit nodes are not involved. It is reasonable to assume that this entity can break the onion routing, not Tor&#39;s encryption itself.</p><h4 id="adversaries-identified-1" tabindex="-1"><a class="header-anchor" href="#adversaries-identified-1"><span>Adversaries identified</span></a></h4><ul><li>Tor breaker</li></ul><h3 id="wasabi-wallet-light-node" tabindex="-1"><a class="header-anchor" href="#wasabi-wallet-light-node"><span>Wasabi Wallet light node</span></a></h3><h4 id="private-utxo-retrieval-1" tabindex="-1"><a class="header-anchor" href="#private-utxo-retrieval-1"><span>Private UTXO retrieval</span></a></h4><p>The indexer (backend) server serves block filters to all the clients over Tor. From those filters, the clients figure out which blocks they are interested in and download them (and some false positive blocks) from peers. One block per peer, and always over a fresh Tor stream. When a block is acquired, the peer gets disconnected. Because of the end-to-end encryption of the onion network, it immediately defeats an ISP adversary and makes the already impossible job of the Sybil adversary even more impossible. The only adversary that could possibly overcome this would have to setup thousands of full nodes over Tor and also break Tor itself.</p><h4 id="private-transaction-broadcasting-1" tabindex="-1"><a class="header-anchor" href="#private-transaction-broadcasting-1"><span>Private transaction broadcasting</span></a></h4><p>All Wasabi traffic is tunneled through Tor. Wasabi connects only to onion nodes, so end-to-end encryption is enforced between the wallet and peers. All this without involving any exit node. Wasabi connects to each peer through a different Tor stream. A new Bitcoin peer is chosen for every transaction broadcast.</p><div class="custom-container tip"><p class="custom-container-title">Everything over Tor!</p><p>Wasabi broadcast transactions to only one peer over Tor, and immediately after that the peer is disconnected.</p></div><h4 id="adversaries-identified-2" tabindex="-1"><a class="header-anchor" href="#adversaries-identified-2"><span>Adversaries identified</span></a></h4><ul><li>ISP</li><li>Tor Breaker Sybil Attacker With Thousands Of Full Nodes Over Onion</li></ul><h3 id="wasabi-wallet-full-node" tabindex="-1"><a class="header-anchor" href="#wasabi-wallet-full-node"><span>Wasabi Wallet + full node</span></a></h3><p>Wasabi can connect to a specified node using the Bitcoin RPC interface.</p><h4 id="private-utxo-retrieval-2" tabindex="-1"><a class="header-anchor" href="#private-utxo-retrieval-2"><span>Private UTXO retrieval</span></a></h4><p>If a specific node is connected, Wasabi will fetch the blocks from this node. Using Wasabi this way results in the same privacy model as Bitcoin Core&#39;s, regarding Private UTXO Retrieval.</p><h4 id="private-transaction-broadcasting-2" tabindex="-1"><a class="header-anchor" href="#private-transaction-broadcasting-2"><span>Private transaction broadcasting</span></a></h4><p>Wasabi will first try to broadcast a transaction to the connected full node. If the node is not available it will broadcast to the Bitcoin P2P network or an external site, over Tor.</p><p>Read more <a class="route-link" href="/FAQ/FAQ-UseWasabi.html#how-is-the-transaction-broadcast">here</a>.</p><h2 id="universal-attacks" tabindex="-1"><a class="header-anchor" href="#universal-attacks"><span>Universal Attacks</span></a></h2><p>Every time you use software that interacts with a Bitcoin network, and especially a Bitcoin node, you leave a sticky fingerprint in your traffic. It comes in the form of a small but unavoidable spike in volume every time a new block is mined and the nodes start gossiping about it. The blocks in Bitcoin are quite big, and the propagation speed is critical for consensus (greater delay means more frequent accidental forks), so such effect is predictable, and, in a sense, inherent to the Bitcoin architecture.</p><p>Notably, the volume of block-related messages was drastically reduced since the introduction of Compact Block Relay (<a href="https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki" target="_blank" rel="noopener noreferrer">BIP 152<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. Instead of requesting whole blocks, mostly consisting of transactions already known to the node, the peer informed of a new block is only requesting the missing transactions. Yet the amount of extra communications in the seconds following a new block is still considerable. This effect may not be noticeable for a single block, but over time it gets statistically significant and may get exploited.</p><p>As reported by <a href="https://m417z.com/bitsniff/" target="_blank" rel="noopener noreferrer">Niko Kudriastev and Michael Maltsev<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, it is possible to detect Bitcoin communications using nothing but traffic volume over time - a piece of information even most privacy concerned individuals are likely leaking to their law-abiding Internet Service Provider. In this case, using a VPN and running the node over Tor may not be enough to avoid being detected.</p><h3 id="protection" tabindex="-1"><a class="header-anchor" href="#protection"><span>Protection</span></a></h3><p>There are many ways to go about it, but staying completely undetected is far from trivial - traditional privacy-enhancing tools mostly focus on the packet level, which is orthogonal to the technique. Let’s break down the potential defense vectors.</p><ul><li><p><strong>VPN / Tor</strong> - unlikely to affect the time series shape much, and therefore for larger traffic lengths the statistical significance of block-related spikes will inevitably become overwhelming.</p></li><li><p><strong>Traffic mixing</strong> - for traffic volumes that are orders of magnitude higher than Bitcoin P2P communications, mixing is likely to be very effective. That would, however, demand constant shielding of both upstream and downstream communications, and couldn&#39;t be done effectively by just running the node on a general-purpose machine - any noticeably long unshielded period may be enough for detection.</p></li><li><p><strong>Being your own ISP</strong> - too spicy for most, but that should work.</p></li><li><p><strong>Blockstream Satellite</strong> - the ultimate solution. Eliminates the traffic analysis threat altogether.</p></li></ul><p>Beyond active measures available now, both the privacy and the bandwidth efficiency of Bitcoin communications are actively worked on. It is entirely possible that the messaging protocol will get to the point where block propagation doesn&#39;t trigger any significant spikes in traffic volume.</p><p>You can read more about BitSniff <a href="https://79jke.github.io/BitSniff/" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> and check the interactive demo <a href="https://m417z.com/bitsniff/" target="_blank" rel="noopener noreferrer">here<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><p><a href="https://youtu.be/9S8xsDq3PTU" target="_blank" rel="noopener noreferrer"><img src="/Logo_without_text_with_bg_dark_with_yt.png" alt="Watch the video"><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/WalletWasabi/WasabiDoc/edit/master/docs/why-wasabi/NetworkLevelPrivacy.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><nav class="page-nav" aria-label="page navigation"><p class="inner"><span class="prev"><a class="route-link" href="/why-wasabi/TransactionGraph.html" aria-label="Transaction Graph"><!--[--><!--]--> Transaction Graph <!--[--><!--]--></a></span><span class="next"><a class="route-link" href="/why-wasabi/TransactionSurveillanceCompanies.html" aria-label="Transaction Surveillance Companies"><!--[--><!--]--> Transaction Surveillance Companies <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-B4LRDA6D.js" defer></script>
  </body>
</html>
